---
import siteConfig from '../data/site-config.json';
import { url } from '../utils/links';

const widgetUrl = siteConfig.prayerTimes.widgetUrl;
const screenWidgetUrl = siteConfig.prayerTimes.screenWidgetUrl;
const liveTimesUrl = siteConfig.prayerTimes.liveTimesUrl;
const yearlyCalendarUrl = siteConfig.prayerTimes.yearlyCalendarUrl;
// Only show widget if we have a working widget URL
const hasWidget = widgetUrl && widgetUrl.length > 0;
const hasLiveLinks = liveTimesUrl && liveTimesUrl.length > 0;
const hasYearlyCalendar = yearlyCalendarUrl && yearlyCalendarUrl.length > 0;

// Sample prayer times - these would be replaced by Mawaqit when configured
const dailyPrayers = [
  { name: 'Fajr', arabic: 'الفجر', time: '6:30 AM', icon: 'sunrise' },
  { name: 'Dhuhr', arabic: 'الظهر', time: '1:00 PM', icon: 'sun' },
  { name: 'Asr', arabic: 'العصر', time: '4:30 PM', icon: 'sunset' },
  { name: 'Maghrib', arabic: 'المغرب', time: '6:15 PM', icon: 'moon-rise' },
  { name: 'Isha', arabic: 'العشاء', time: '7:30 PM', icon: 'moon' },
];

const icons: Record<string, string> = {
  'sunrise': `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />`,
  'sun': `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />`,
  'sunset': `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />`,
  'moon-rise': `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />`,
  'moon': `<path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />`,
};
---

<section class="py-12 sm:py-16 bg-gradient-to-b from-gray-50 to-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="text-center mb-8">
      <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 font-heading mb-2">Iqamah Prayer Times</h2>
      <p class="text-gray-600 text-sm sm:text-base">Daily prayers at Prince William Islamic Center</p>
    </div>

    {hasWidget ? (
      <!-- Mawaqit Widget Embed -->
      <div class="max-w-4xl mx-auto">
        <div class="mawaqit-widget bg-white rounded-2xl shadow-lg overflow-hidden border border-gray-100 p-2">
          <iframe 
            src={widgetUrl}
            frameborder="0"
            scrolling="no"
            style="width: 100%; min-height: 500px; border: 0;"
            title="Prayer Times - MAWAQIT"
            class="widget"
          />
        </div>
        <div class="mt-4 flex flex-wrap justify-center gap-2">
          {hasYearlyCalendar && (
            <a 
              href={yearlyCalendarUrl}
              target="_blank"
              rel="noopener noreferrer"
              class="inline-flex items-center gap-1.5 px-4 py-2 bg-white text-primary-700 border border-primary-200 rounded-full hover:bg-primary-50 transition-colors font-medium text-sm"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              Yearly Calendar
            </a>
          )}
          <a 
            href={liveTimesUrl}
            target="_blank"
            rel="noopener noreferrer"
            class="inline-flex items-center gap-1.5 px-4 py-2 bg-primary-100 text-primary-700 rounded-full hover:bg-primary-200 transition-colors font-medium text-sm"
          >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
            </svg>
            Full Page
          </a>
        </div>
      </div>
    ) : (
      <div class="max-w-5xl mx-auto">
        <!-- All Prayer Times in One Row -->
        <div class="grid grid-cols-3 sm:grid-cols-6 gap-3 sm:gap-4">
          <!-- Jummah - Same size as others -->
          <div class="bg-gradient-to-br from-primary-700 to-primary-800 rounded-xl p-4 sm:p-5 text-center shadow-lg">
            <div class="text-white/70 text-xs sm:text-sm font-medium uppercase tracking-wide mb-1">Friday</div>
            <h4 class="text-white font-semibold text-base sm:text-lg mb-0.5">Jummah</h4>
            <p class="text-xl sm:text-2xl font-bold text-white">1:00 PM</p>
          </div>
          
          <!-- Daily Prayers -->
          {dailyPrayers.map((prayer) => (
            <div class="bg-white rounded-xl p-4 sm:p-5 text-center shadow-md border border-gray-100 hover:shadow-lg transition-shadow">
              <div class="text-primary-500 text-xs sm:text-sm font-medium mb-1">{prayer.arabic}</div>
              <h4 class="text-gray-800 font-semibold text-base sm:text-lg mb-0.5">{prayer.name}</h4>
              <p class="text-xl sm:text-2xl font-bold text-primary-700">{prayer.time}</p>
            </div>
          ))}
        </div>

        <!-- Action Buttons -->
        <div class="mt-6 flex flex-wrap justify-center gap-2">
          {hasLiveLinks && liveTimesUrl && (
            <a 
              href={liveTimesUrl}
              target="_blank"
              rel="noopener noreferrer"
              class="inline-flex items-center gap-1.5 px-4 py-2 bg-white text-primary-700 border border-primary-200 rounded-full hover:bg-primary-50 transition-colors font-medium text-sm"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
              Live Times
            </a>
          )}
          {hasYearlyCalendar && (
            <a 
              href={yearlyCalendarUrl}
              target="_blank"
              rel="noopener noreferrer"
              class="inline-flex items-center gap-1.5 px-4 py-2 bg-primary-100 text-primary-700 rounded-full hover:bg-primary-200 transition-colors font-medium text-sm"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
              Yearly Calendar
            </a>
          )}
          <a 
            href={url('/screen')}
            target="_blank"
            class="inline-flex items-center gap-1.5 px-4 py-2 bg-primary-600 text-white rounded-full hover:bg-primary-700 transition-colors font-medium text-sm"
          >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
            </svg>
            TV Display
          </a>
        </div>

        <!-- Note -->
        <p class="mt-4 text-center text-gray-500 text-xs sm:text-sm">
          Iqamah times shown. Athan times vary daily.
        </p>
      </div>
    )}
  </div>
</section>
